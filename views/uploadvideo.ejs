<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Class Track</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles/class.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Navigation Bar -->
      <%- include('partials/nameheader.ejs') %>

    <!-- Main Content -->
    <div class="content-container">
      <div class="content-box">
        <h2>Before You Submit, Make Sure:</h2>

        <ul class="checklist-points">
          <li>You recorded in <b>good lighting</b></li>
          <li>You're wearing your <b>glasses</b> (if you normally do)</li>
          <li>The video is <b>clear and high quality</b></li>
          <li>You looked in <b>all directions</b> (left, right, up, down)</li>
          <li>The <b>background is plain white</b> with no distractions</li>
          <li><b>No filters</b> or beauty effects are used</li>
          <li>The video <b>is 10-15 seconds</b> long</li>
        </ul>

        <div class="upload-section">
          <div class="upload-controls">
            <form
              id="uploadForm"
              action="/upload"
              method="post"
              enctype="multipart/form-data"
            >
              <input
                id="videoUpload"
                type="file"
                name="video"
                accept="video/*"
                style="display: none"
                onchange="document.getElementById('uploadForm').submit()" 
              />
              <label for="videoUpload" class="upload-btn"
                >Upload Video (Max: 10MB)</label
              >
            </form>
            <span id="fileName">No file chosen</span>
            <p>
              <% if (result && result.length > 0) { %>
              <p><%= result %></p>
              <% } else { %>
              <p>No video to evaluate</p>
              <% } %>
            </p>
          </div>
          <p class="note">
            Kindly ensure you have followed all the guidelines below before
            submission.
          </p>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS Bundle with Popper -->
<script>
function displayUserInfo() {
  let currentUser = localStorage.getItem("currentUser");

  if (!currentUser) {
    // No user found, create from server-side value
    console.log("No user found in localStorage");
    currentUser = {
      fullName: "Hassan",
      firstName: "HA",
    };
    localStorage.setItem("currentUser", JSON.stringify(currentUser));
  } else {
    console.log("User found in localStorage");
    currentUser = JSON.parse(currentUser);
  }

  // Display user's full name
  const userNameElement = document.getElementById("user-name");
  if (userNameElement) {
    userNameElement.textContent = currentUser.fullName;
  }

  // Display first character of first name
  const userCharElement = document.getElementById("user-char");
  if (userCharElement) {
    userCharElement.textContent = currentUser.firstName.charAt(0);
  }
}

document.addEventListener("DOMContentLoaded", displayUserInfo);
</script>

</body>
</html>